if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then(a=>t.resolve(e()).then(()=>a),a=>t.resolve(e()).then(()=>{throw a}))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n={exports:{}};n.exports=function(){function e(e){var n=[];return e.AMapUI&&n.push(t(e.AMapUI)),e.Loca&&n.push(a(e.Loca)),Promise.all(n)}function t(e){return new Promise(function(t,a){var o=[];if(e.plugins)for(var s=0;s<e.plugins.length;s+=1)-1==i.AMapUI.plugins.indexOf(e.plugins[s])&&o.push(e.plugins[s]);if(r.AMapUI===n.failed)a("前次请求 AMapUI 失败");else if(r.AMapUI===n.notload){r.AMapUI=n.loading,i.AMapUI.version=e.version||i.AMapUI.version,s=i.AMapUI.version;var c=document.body||document.head,u=document.createElement("script");u.type="text/javascript",u.src="https://webapi.amap.com/ui/"+s+"/main.js",u.onerror=function(e){r.AMapUI=n.failed,a("请求 AMapUI 失败")},u.onload=function(){if(r.AMapUI=n.loaded,o.length)window.AMapUI.loadUI(o,function(){for(var e=0,a=o.length;e<a;e++){var n=o[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}for(t();l.AMapUI.length;)l.AMapUI.splice(0,1)[0]()});else for(t();l.AMapUI.length;)l.AMapUI.splice(0,1)[0]()},c.appendChild(u)}else r.AMapUI===n.loaded?e.version&&e.version!==i.AMapUI.version?a("不允许多个版本 AMapUI 混用"):o.length?window.AMapUI.loadUI(o,function(){for(var e=0,a=o.length;e<a;e++){var n=o[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}t()}):t():e.version&&e.version!==i.AMapUI.version?a("不允许多个版本 AMapUI 混用"):l.AMapUI.push(function(e){e?a(e):o.length?window.AMapUI.loadUI(o,function(){for(var e=0,a=o.length;e<a;e++){var n=o[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}t()}):t()})})}function a(e){return new Promise(function(t,a){if(r.Loca===n.failed)a("前次请求 Loca 失败");else if(r.Loca===n.notload){r.Loca=n.loading,i.Loca.version=e.version||i.Loca.version;var o=i.Loca.version,s=i.AMap.version.startsWith("2"),c=o.startsWith("2");if(s&&!c||!s&&c)a("JSAPI 与 Loca 版本不对应！！");else{s=i.key,c=document.body||document.head;var u=document.createElement("script");u.type="text/javascript",u.src="https://webapi.amap.com/loca?v="+o+"&key="+s,u.onerror=function(e){r.Loca=n.failed,a("请求 AMapUI 失败")},u.onload=function(){for(r.Loca=n.loaded,t();l.Loca.length;)l.Loca.splice(0,1)[0]()},c.appendChild(u)}}else r.Loca===n.loaded?e.version&&e.version!==i.Loca.version?a("不允许多个版本 Loca 混用"):t():e.version&&e.version!==i.Loca.version?a("不允许多个版本 Loca 混用"):l.Loca.push(function(e){e?a(e):a()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var n,o;(o=n||(n={})).notload="notload",o.loading="loading",o.loaded="loaded",o.failed="failed";var i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},r={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},l={AMapUI:[],Loca:[]},s=[],c=function(e){"function"==typeof e&&(r.AMap===n.loaded?e(window.AMap):s.push(e))};return{load:function(t){return new Promise(function(a,o){if(r.AMap==n.failed)o("");else if(r.AMap==n.notload){var l=t.key,u=t.version,d=t.plugins;l?(window.AMap&&"lbs.amap.com"!==location.host&&o("禁止多种API加载方式混用"),i.key=l,i.AMap.version=u||i.AMap.version,i.AMap.plugins=d||i.AMap.plugins,r.AMap=n.loading,u=document.body||document.head,window.___onAPILoaded=function(i){if(delete window.___onAPILoaded,i)r.AMap=n.failed,o(i);else for(r.AMap=n.loaded,e(t).then(function(){a(window.AMap)}).catch(o);s.length;)s.splice(0,1)[0]()},(d=document.createElement("script")).type="text/javascript",d.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+i.AMap.version+"&key="+l+"&plugin="+i.AMap.plugins.join(","),d.onerror=function(e){r.AMap=n.failed,o(e)},u.appendChild(d)):o("请填写key")}else if(r.AMap==n.loaded)if(t.key&&t.key!==i.key)o("多个不一致的 key");else if(t.version&&t.version!==i.AMap.version)o("不允许多个版本 JSAPI 混用");else{if(l=[],t.plugins)for(u=0;u<t.plugins.length;u+=1)-1==i.AMap.plugins.indexOf(t.plugins[u])&&l.push(t.plugins[u]);l.length?window.AMap.plugin(l,function(){e(t).then(function(){a(window.AMap)}).catch(o)}):e(t).then(function(){a(window.AMap)}).catch(o)}else if(t.key&&t.key!==i.key)o("多个不一致的 key");else if(t.version&&t.version!==i.AMap.version)o("不允许多个版本 JSAPI 混用");else{var p=[];if(t.plugins)for(u=0;u<t.plugins.length;u+=1)-1==i.AMap.plugins.indexOf(t.plugins[u])&&p.push(t.plugins[u]);c(function(){p.length?window.AMap.plugin(p,function(){e(t).then(function(){a(window.AMap)}).catch(o)}):e(t).then(function(){a(window.AMap)}).catch(o)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},r={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},l={AMap:[],AMapUI:[],Loca:[]}}}}();const o=a(n.exports),i=(e,t)=>{const a=e.__vccOpts||e;for(const[n,o]of t)a[n]=o;return a},r={props:{startNavigation:{type:Boolean,default:!1},regenerateRoute:{type:Boolean,default:!1},currentRouteIndex:{type:Number,default:0},routes:{type:Array,default:()=>[]}},emits:["navigation-ready","route-generated"],setup(a,{emit:n}){let i=null,r=null,l=null,s=null,c=null,u=null,d=null,p=0,g=[];const m=e.ref(!1),h=e.ref(0),f=e.ref({icon:"↑",instruction:"准备导航...",distance:"计算中..."});return e.onMounted(()=>{t("log","at pages/MapContainer.vue:69","MapContainer 组件挂载，开始初始化地图..."),window._AMapSecurityConfig={securityJsCode:"aca55b5cc6a9a9aabb99860e12d4bffe"},o.load({key:"8543c182e1fdf2e2a508de70ebed62ea",version:"2.0",plugins:["AMap.Scale","AMap.Geolocation","AMap.Marker","AMap.InfoWindow","AMap.Walking","AMap.Polyline"]}).then(o=>{t("log","at pages/MapContainer.vue:89","高德地图API加载成功"),i=new o.Map("container",{viewMode:"3D",pitch:50,buildingAnimation:!0,terrain:!0,zoom:16,center:[116.397428,39.90923]});const v=new o.Scale({position:"LB",offset:new o.Pixel(10,60)});function w(e,a){t("log","at pages/MapContainer.vue:196","最终位置:",e,"来源:",a.message||"高德定位"),i.setCenter(e),i.setZoom(16),c&&i.remove(c),c=new o.Marker({position:e,icon:new o.Icon({size:new o.Size(24,24),image:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiIGZpbGw9IiMwMDY2RkYiIGZpbGwtb3BhY2l0eT0iMC44Ii8+CjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjYiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9IiMwMDY2RkYiLz4KPC9zdmc+",imageSize:new o.Size(24,24)}),zIndex:100,angle:a.heading||0}),i.add(c),y(e)}function y(e){t("log","at pages/MapContainer.vue:226","正在从当前位置生成2公里内步行路线:",e);const a=2*Math.random()*Math.PI,r=.0045+.0045*Math.random(),c={name:"当前位置1-1.5公里步行路线",start:e,end:[e[0]+r*Math.cos(a),e[1]+r*Math.sin(a)],distance:"1-1.5公里",actualDistance:"计算中...",duration:"计算中..."};s=c,u&&i.remove(u),l.search(c.start,c.end,(e,a)=>{if(t("log","at pages/MapContainer.vue:255","步行导航结果:",e,a),"complete"===e){const e=a.routes[0].path,r=a.routes[0].distance,l=a.routes[0].time;c.actualDistance=(r/1e3).toFixed(1)+"公里",c.duration=Math.ceil(l/60)+"分钟",u=new o.Polyline({path:e,isOutline:!0,outlineColor:"#ffeeee",borderWeight:2,strokeColor:"#3366FF",strokeOpacity:.9,strokeWeight:6,strokeStyle:"solid",lineJoin:"round",lineCap:"round",zIndex:50}),i.add(u),i.setFitView([u]),t("log","at pages/MapContainer.vue:286","2公里内路线生成完成:",c),n("route-generated",c),n("navigation-ready",a)}else t("log","at pages/MapContainer.vue:290","步行导航失败，使用备用方案"),A(c)})}function A(e){const t=[e.start,e.end];u=new o.Polyline({path:t,isOutline:!0,outlineColor:"#ffeeee",borderWeight:2,strokeColor:"#FF6B6B",strokeOpacity:.8,strokeWeight:5,strokeStyle:"dashed",strokeDasharray:[10,5],lineJoin:"round",lineCap:"round",zIndex:50}),i.add(u),i.setFitView([u]),e.actualDistance="约2公里",e.duration="约25分钟",n("route-generated",e)}function M(){s&&l&&(t("log","at pages/MapContainer.vue:325","开始2公里内导航:",s),u&&i.remove(u),l.search(s.start,s.end,(e,a)=>{if("complete"===e){t("log","at pages/MapContainer.vue:333","2公里内导航开始");const e=a.routes[0].path;!function(e){g=e.map((e,t)=>{const a=e.instruction;let n="↑";return a.includes("左转")?n="←":a.includes("右转")?n="→":a.includes("掉头")?n="↓":a.includes("到达终点")&&(n="⚑"),{icon:n,instruction:a,distance:e.distance>1e3?(e.distance/1e3).toFixed(1)+"公里":Math.round(e.distance)+"米",position:e.path[0]}}),g.length>0&&(f.value=g[0],p=0);m.value=!0}(a.routes[0].steps),function(e){d&&d.clear();u=new o.Polyline({path:e,isOutline:!0,outlineColor:"#ffeeee",borderWeight:2,strokeColor:"#3366FF",strokeOpacity:.9,strokeWeight:6,strokeStyle:"solid",lineJoin:"round",lineCap:"round",zIndex:50}),i.add(u),i.setFitView([u]),d=r.watchPosition({enableHighAccuracy:!0,timeout:5e3,maximumAge:0,convert:!0}),r.on("complete",b),function(e){let t=0;const a=e.length;let n=null;const r=setInterval(()=>{if(!m.value||t>=a)return void clearInterval(r);const l=e[t];let s=0;if(t>0){const a=e[t-1],n=e[t];s=180*Math.atan2(n.lng-a.lng,n.lat-a.lat)/Math.PI}if(n){if(o.GeometryUtil.distance([n.lng,n.lat],[l.lng,l.lat])>50){const e={lng:n.lng+.1*(l.lng-n.lng),lat:n.lat+.1*(l.lat-n.lat)};c&&(c.setPosition([e.lng,e.lat]),c.setAngle(s)),i.setCenter([e.lng,e.lat]),I([e.lng,e.lat]),n=e}else c&&(c.setPosition([l.lng,l.lat]),c.setAngle(s)),i.setCenter([l.lng,l.lat]),I([l.lng,l.lat]),n=l}else c&&(c.setPosition([l.lng,l.lat]),c.setAngle(s)),i.setCenter([l.lng,l.lat]),I([l.lng,l.lat]),n=l;if(t++,h.value=t/a*100,t%Math.floor(Math.max(1,a/g.length))===0){const e=Math.min(Math.floor(t/Math.max(1,a/g.length)),g.length-1);f.value=g[e]}},800)}(e)}(e)}}))}function b(e){if(!m.value)return;const t=[e.position.lng,e.position.lat],a=e.heading||0;c&&(c.setPosition(t),c.setAngle(a)),i.setCenter(t),I(t)}function I(e){if(!s||!u||0===g.length)return;const t=s.end,a=o.GeometryUtil.distance(e,t),n=parseFloat(s.actualDistance),i=Math.max(0,Math.min(100,100-a/(10*n)));if(h.value=i,p<g.length-1){const t=g[p+1].position;o.GeometryUtil.distance(e,t)<30&&(p++,f.value=g[p])}a<20&&(m.value=!1,d&&(d.clear(),r.off("complete",b)),f.value={icon:"⚑",instruction:"已到达目的地",distance:"0米"})}i.addControl(v),r=new o.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonPosition:"RB",buttonOffset:new o.Pixel(10,100),zoomToAccuracy:!0,showButton:!0,showMarker:!1,showCircle:!0}),i.addControl(r),i.on("complete",function(){setTimeout(()=>{document.querySelectorAll(".amap-logo, .amap-copyright").forEach(e=>{e&&(e.style.display="none")})},100)}),l=new o.Walking({map:i,hideMarkers:!1,isOutline:!0,outlineColor:"#ffeeee",autoFitView:!0}),t("log","at pages/MapContainer.vue:145","开始获取当前位置..."),r.getCurrentPosition((e,a)=>{if(t("log","at pages/MapContainer.vue:149","定位状态:",e,"结果:",a),"complete"===e){const e=[a.position.lng,a.position.lat];t("log","at pages/MapContainer.vue:153","定位成功:",e),w(e,a)}else t("log","at pages/MapContainer.vue:156","定位失败，使用浏览器API"),navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{const a=[e.coords.longitude,e.coords.latitude];t("log","at pages/MapContainer.vue:167","浏览器定位成功:",a),w(a,{position:{lng:a[0],lat:a[1]},message:"浏览器定位"})},e=>{t("log","at pages/MapContainer.vue:174","浏览器定位失败:",e),w([116.397428,39.90923],{message:"默认位置"})},{enableHighAccuracy:!0,timeout:8e3,maximumAge:0}):(t("log","at pages/MapContainer.vue:187","浏览器不支持定位，使用默认位置"),w([116.397428,39.90923],{message:"默认位置"}))}),e.watch(()=>a.startNavigation,e=>{e&&M()}),e.watch(()=>a.currentRouteIndex,(e,r)=>{if(a.routes&&a.routes.length>0&&e!==r){t("log","at pages/MapContainer.vue:604","路线索引变化:",e);const r=a.routes[e];if(r&&void 0!==r.routeAngle){const e=s?s.start:[116.397428,39.90923],a=r.routeAngle*Math.PI/180,c=r.actualDistance?.009*r.actualDistance:.009,d=[e[0]+c*Math.cos(a),e[1]+c*Math.sin(a)],p={name:r.title,start:e,end:d,distance:r.distance,actualDistance:r.actualDistance||"1公里",duration:r.duration};s=p,u&&i.remove(u),l.search(p.start,p.end,(e,a)=>{if("complete"===e){const e=a.routes[0].path;u=new o.Polyline({path:e,isOutline:!0,outlineColor:"#ffeeee",borderWeight:2,strokeColor:"#3366FF",strokeOpacity:.9,strokeWeight:6,strokeStyle:"solid",lineJoin:"round",lineCap:"round",zIndex:50}),i.add(u),i.setFitView([u]),n("route-generated",p)}else t("log","at pages/MapContainer.vue:658","步行导航失败，使用备用方案"),A(p)})}}},{immediate:!0}),e.watch(()=>a.regenerateRoute,e=>{if(e)if(a.routes&&a.routes.length>0){const e=a.currentRouteIndex,t=a.routes[e];if(t&&void 0!==t.routeAngle){const e=s?s.start:[116.397428,39.90923],a=t.routeAngle*Math.PI/180,r=t.actualDistance?.009*t.actualDistance:.009,c=[e[0]+r*Math.cos(a),e[1]+r*Math.sin(a)],d={name:t.title,start:e,end:c,distance:t.distance,actualDistance:t.actualDistance||"1公里",duration:t.duration};s=d,u&&i.remove(u),l.search(d.start,d.end,(e,t)=>{if("complete"===e){const e=t.routes[0].path;u=new o.Polyline({path:e,isOutline:!0,outlineColor:"#ffeeee",borderWeight:2,strokeColor:"#3366FF",strokeOpacity:.9,strokeWeight:6,strokeStyle:"solid",lineJoin:"round",lineCap:"round",zIndex:50}),i.add(u),i.setFitView([u]),n("route-generated",d)}else A(d)})}else y(s?s.start:[116.397428,39.90923])}else y(s?s.start:[116.397428,39.90923])})}).catch(e=>{t("error","at pages/MapContainer.vue:734","地图加载失败：",e)})}),{isNavigating:m,navigationProgress:h,currentDirection:f}}};__definePage("pages/index/index",i({components:{MapContainer:i(r,[["render",function(t,a,n,o,i,r){return e.openBlock(),e.createElementBlock("view",{id:"container"},[o.isNavigating?(e.openBlock(),e.createElementBlock("view",{key:0,class:"navigation-guide"},[e.createElementVNode("view",{class:"guide-content"},[e.createElementVNode("view",{class:"direction-icon"},e.toDisplayString(o.currentDirection.icon),1),e.createElementVNode("view",{class:"guide-info"},[e.createElementVNode("text",{class:"guide-instruction"},e.toDisplayString(o.currentDirection.instruction),1),e.createElementVNode("text",{class:"guide-distance"},e.toDisplayString(o.currentDirection.distance),1)])]),e.createElementVNode("view",{class:"progress-bar"},[e.createElementVNode("view",{class:"progress",style:e.normalizeStyle({width:o.navigationProgress+"%"})},null,4)])])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-d66b80c5"]])},data:()=>({selectedTime:"30min",activeNav:null,startNavigationFlag:!1,currentRoute:null,regenerateRoute:!1,currentCardIndex:0,cardTransition:!1,isFullScreenNavigation:!1,routesData:{"30min":[{title:"文艺咖啡小径",distance:"0.8公里",duration:"约15分钟",actualDistance:.8,images:["https://images.unsplash.com/photo-1501339847302-ac426a4a7cbb?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1442512595331-e89e73853f31?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80"],type:"enhanced-card",routeAngle:45},{title:"历史建筑之旅",distance:"1.2公里",duration:"约20分钟",actualDistance:1.2,images:["https://images.unsplash.com/photo-1519501025264-65ba15a82390?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1465447142348-e9952c393450?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80"],type:"dark-card",routeAngle:135}],"2h":[{title:"城市公园漫步",distance:"3.5公里",duration:"约45分钟",actualDistance:3.5,images:["https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1447752875215-b2761acb3c5d?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80"],type:"enhanced-card",routeAngle:60},{title:"艺术街区探索",distance:"2.8公里",duration:"约35分钟",actualDistance:2.8,images:["https://images.unsplash.com/photo-1511406361295-0a1ff814c0ce?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1541961017774-22349e4a1262?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80"],type:"dark-card",routeAngle:240}],halfday:[{title:"郊外山野徒步",distance:"8.2公里",duration:"约2.5小时",actualDistance:8.2,images:["https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1501785888041-af3ef285b470?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80"],type:"enhanced-card",routeAngle:90},{title:"古镇文化之旅",distance:"6.5公里",duration:"约2小时",actualDistance:6.5,images:["https://images.unsplash.com/photo-1519501025264-65ba15a82390?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1465447142348-e9952c393450?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80","https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?ixlib=rb-1.2.1&auto=format&fit=crop&w=400&h=300&q=80"],type:"dark-card",routeAngle:270}]}}),computed:{currentRoutes(){return this.routesData[this.selectedTime]||[]},currentTimeLabel(){return{"30min":"30","2h":"2h",halfday:"半天"}[this.selectedTime]||"30"}},mounted(){this.$nextTick(()=>{setTimeout(()=>{this.currentRoutes.length>0&&(this.regenerateRoute=!0,setTimeout(()=>{this.regenerateRoute=!1},200))},500)})},methods:{selectTime(e){this.selectedTime=e,this.currentCardIndex=0,this.regenerateRoute=!0,setTimeout(()=>{this.regenerateRoute=!1},100)},startNavigation(){this.activeNav="navigate",this.startNavigationFlag=!0,this.isFullScreenNavigation=!0,setTimeout(()=>{this.startNavigationFlag=!1},2e3)},exitNavigation(){this.isFullScreenNavigation=!1,this.startNavigationFlag=!1,this.$nextTick(()=>{const e=this.$refs.mapContainer;e&&"function"==typeof e.stopNavigation&&e.stopNavigation()})},dislike(){this.activeNav="dislike",this.currentCardIndex<this.currentRoutes.length-1?this.currentCardIndex++:this.currentCardIndex=0},bookmark(){this.activeNav="bookmark"},onRouteGenerated(e){this.currentRoute=e},onNavigationReady(e){t("log","at pages/index/index.vue:321","导航准备就绪:",e)}}},[["render",function(t,a,n,o,i,r){var l;const s=e.resolveComponent("MapContainer");return e.openBlock(),e.createElementBlock("view",{class:"container"},[i.isFullScreenNavigation?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"header"},[e.createElementVNode("view",{class:"logo-section"},[e.createElementVNode("i",{class:"fas fa-walking fa-2x",style:{color:"rgba(253, 221, 220, 1)"}}),e.createElementVNode("text",{class:"logo-text"},"第二条街")]),e.createElementVNode("view",{class:"header-actions"},[e.createElementVNode("i",{class:"fas fa-search",style:{color:"rgba(255, 255, 255, 0.8)"}}),e.createElementVNode("i",{class:"fas fa-navicon",style:{color:"rgba(255, 255, 255, 0.8)"}})])])),i.isFullScreenNavigation?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"time-selector"},[e.createElementVNode("view",{class:"time-options"},[e.createElementVNode("button",{class:e.normalizeClass(["time-option","30min"===i.selectedTime?"active":""]),onClick:a[0]||(a[0]=e=>r.selectTime("30min"))},[e.createElementVNode("view",{class:e.normalizeClass(["time-circle","30min"!==i.selectedTime?"inactive":""])},[e.createElementVNode("text",{class:"time-text"},"0.5"),e.createElementVNode("text",{class:"time-unit"},"小时")],2),e.createElementVNode("text",{class:"time-label"},"散步")],2),e.createElementVNode("button",{class:e.normalizeClass(["time-option","2h"===i.selectedTime?"active":""]),onClick:a[1]||(a[1]=e=>r.selectTime("2h"))},[e.createElementVNode("view",{class:e.normalizeClass(["time-circle","2h"!==i.selectedTime?"inactive":""])},[e.createElementVNode("text",{class:"time-text"},"2"),e.createElementVNode("text",{class:"time-unit"},"小时")],2),e.createElementVNode("text",{class:"time-label"},"闲逛")],2),e.createElementVNode("button",{class:e.normalizeClass(["time-option","halfday"===i.selectedTime?"active":""]),onClick:a[2]||(a[2]=e=>r.selectTime("halfday"))},[e.createElementVNode("view",{class:e.normalizeClass(["time-circle","halfday"!==i.selectedTime?"inactive":""])},[e.createElementVNode("text",{class:"time-text"},"半天")],2),e.createElementVNode("text",{class:"time-label"},"郊游")],2)])])),e.createElementVNode("view",{class:e.normalizeClass(["map-container",{fullscreen:i.isFullScreenNavigation}])},[e.createVNode(s,{ref:"mapContainer","regenerate-route":i.regenerateRoute,"current-route-index":i.currentCardIndex,routes:r.currentRoutes,"start-navigation":i.startNavigationFlag,onRouteGenerated:r.onRouteGenerated,onNavigationReady:r.onNavigationReady},null,8,["regenerate-route","current-route-index","routes","start-navigation","onRouteGenerated","onNavigationReady"]),i.isFullScreenNavigation?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"single-card-container"},[e.createVNode(e.Transition,{name:"fade",mode:"out-in"},{default:e.withCtx(()=>{var t,a,n,o,l;return[r.currentRoutes.length>0?(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["single-route-card",(null==(t=r.currentRoutes[i.currentCardIndex])?void 0:t.type)||"enhanced-card"]),key:i.currentCardIndex},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"route-title"},e.toDisplayString(null==(a=r.currentRoutes[i.currentCardIndex])?void 0:a.title),1),e.createElementVNode("view",{class:"route-badge"},[e.createElementVNode("text",null,e.toDisplayString(r.currentTimeLabel),1)])]),e.createElementVNode("view",{class:"route-info"},[e.createElementVNode("i",{class:"fas fa-route"}),e.createElementVNode("text",null,e.toDisplayString(null==(n=r.currentRoutes[i.currentCardIndex])?void 0:n.distance)+" · "+e.toDisplayString(null==(o=r.currentRoutes[i.currentCardIndex])?void 0:o.duration),1)]),e.createElementVNode("view",{class:"route-images"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(null==(l=r.currentRoutes[i.currentCardIndex])?void 0:l.images,(t,a)=>(e.openBlock(),e.createElementBlock("image",{key:a,src:t,mode:"aspectFill",class:"route-image"},null,8,["src"]))),128))]),e.createElementVNode("view",{class:"card-progress"},[e.createElementVNode("text",{class:"progress-text"},e.toDisplayString(i.currentCardIndex+1)+" / "+e.toDisplayString(r.currentRoutes.length),1)])],2)):e.createCommentVNode("",!0)]}),_:1})])),i.isFullScreenNavigation?(e.openBlock(),e.createElementBlock("view",{key:1,class:"navigation-header"},[e.createElementVNode("view",{class:"back-button",onClick:[a[3]||(a[3]=(...e)=>r.exitNavigation&&r.exitNavigation(...e)),a[4]||(a[4]=(...e)=>r.exitNavigation&&r.exitNavigation(...e))]},[e.createElementVNode("i",{class:"fas fa-arrow-left"}),e.createElementVNode("text",null,"返回")]),e.createElementVNode("view",{class:"navigation-title"},[e.createElementVNode("text",null,e.toDisplayString(null==(l=r.currentRoutes[i.currentCardIndex])?void 0:l.title),1)])])):e.createCommentVNode("",!0)],2),i.isFullScreenNavigation?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"bottom-nav"},[e.createElementVNode("view",{class:"nav-container"},[e.createElementVNode("button",{class:"nav-button",onClick:a[5]||(a[5]=(...e)=>r.dislike&&r.dislike(...e))},[e.createElementVNode("view",{class:"nav-circle"},[e.createElementVNode("i",{class:"fas fa-thumbs-down text-lg",style:{color:"rgba(255, 255, 255, 0.5)"}})]),e.createElementVNode("text",{class:"nav-text"},"不喜欢")]),e.createElementVNode("button",{class:"nav-button",onClick:a[6]||(a[6]=(...e)=>r.startNavigation&&r.startNavigation(...e))},[e.createElementVNode("view",{class:"nav-circle primary"},[e.createElementVNode("i",{class:"fas fa-location-arrow text-lg",style:{color:"rgba(55, 11, 11, 1)"}})]),e.createElementVNode("text",{class:"nav-text primary"},"开始导航")]),e.createElementVNode("button",{class:"nav-button",onClick:a[7]||(a[7]=(...e)=>r.bookmark&&r.bookmark(...e))},[e.createElementVNode("view",{class:"nav-circle"},[e.createElementVNode("i",{class:"fas fa-bookmark text-lg",style:{color:"rgba(255, 255, 255, 0.5)"}})]),e.createElementVNode("text",{class:"nav-text"},"收藏")])]),e.createElementVNode("view",{class:"home-indicator"},[e.createElementVNode("view",{class:"indicator-bar"})])]))])}],["__scopeId","data-v-20ff56d4"]]));const l={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}};const{app:s,Vuex:c,Pinia:u}={app:e.createVueApp(l)};uni.Vuex=c,uni.Pinia=u,s.provide("__globalStyles",__uniConfig.styles),s._component.mpType="app",s._component.render=()=>{},s.mount("#app")}(Vue);
